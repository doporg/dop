# 代码管理需求文档

## 一、概述
DOP中代码管理模块用于存储和管理源代码，需要实现gitlab的大部分常用功能，包括项目管理功能、组管理功能以及个人设置功能。在本项目中，代码管理模块主要实现一个定制化的UI界面,服务器端转发请求到gitlab服务。DOP提供代码管理的入口，可跳转进入代码管理完整页面。
## 二、功能点描述
### 2.1 项目管理
#### 2.1.1 新建项目
配置项目名称，项目描述和可见等级来创建一个新的项目
#### 2.1.2 查询项目列表
提供一个项目的列表显示界面，可以查看自己的项目、starred 项目和搜索所有的项目，可以选择列表的排序方式，可以通过项目名称来过滤
##### a.自己的项目列表
>可以查看自己所有参与的项目或者私有项目，列表项上会显示自己在项目中的角色

##### b.starred项目列表
>查看自己的starred项目

##### c.搜索项目
>搜索所有gitlab上的所有项目，分为趋势项目,最多star和所有项目三个页面

#### 2.1.3 删除项目
在项目的settings当中设置删除项目的选项，删除项目给出警告提示，需要输入项目名称来确认删除

#### 2.1.4 查看项目基本信息
点击项目列表中的项目可以进入到展示项目基本信息的页面，包括commit次数、分支数、Tag数、文件大小、fork次数、star次数和clone的方式。


#### 2.1.2 仓库详情
##### a.源文件
>展示源文件的目录结构，显示每个文件和文件夹最后一次commit的信息和时间

>像mac finder一样在目录中前进和后退

>支持点击查看某些格式的文件内容，在网页中编辑文件作为一次提交

>按路径查找文件

>切换分支


##### b.提交
>按时间顺序显示提交，包括提交者、时间、提交信息,点击查看具体的提交内容,可以切换分支，根据提交的信息来搜索提交

>用图表的形式显示提交（点和连线）,可以切换分支

##### c.tag
创建tag，列表显示tag，根据名称搜索tag

##### d.分支
>查看仓库存在的所有分支，通过分支名称来搜索分支

>分支比较，选择源分支和目标分支，比较分支之间的差异

##### e.统计数据
>按照小时、日、月来展示提交次数的图表和每个成员提交次数的图表，可以切换分支

>仓库的各种语言的比例


#### 2.1.3 合并请求
选择源分支和目标分支创建合并请求，新建的请求默认是open状态

若存在冲突，展示存在冲突的地方，可以在网页上直接操作或者本地合并，解决完冲突后可以点击merge，显示为merged状态

请求可以关闭不处理，显示为closed状态



#### 2.1.4 issues
实现与gitlab相同的issues功能

#### 2.1.5 wiki
实现与gitlab相同的wiki功能

#### 2.1.6 项目设置
##### a.基本设置
>(1)	设置项目基本信息例如名称，显示内容(例如是否显示issues,wiki等)

>(2)	设置项目的权限，private or public 等

>(3)	webhook

##### b.成员管理
>可以邀请个人或小组作为开发成员,并同时设定角色,设定截止时间可选

##### c.仓库保护
>(1)	分支保护，按照开发者不同的角色来给分支设定动作的权限,例如只允许maintainer向master分支push

>(2) 	标签保护，设定允许哪些角色来创建tag和更新tag

### 2.2 组管理
新建group，搜索名称、用户名或邮件查找用户，并添加到group当中，需要设定角色,设定截止时间可选

通过名称搜索group，列表显示；删除group

点击查看group详情，包括与group相关的project，group的成员等,可以设定group的可见等级，group名称

从group新建project

### 2.3 个人设置
#### 2.2.1 基本信息
包括用户名、邮箱、个人主页、简介、公司、居住地等等的信息，可以上传头像
#### 2.2.2 邮箱管理
设置用户名绑定的邮箱，用于用户名验证和找回密码
#### 2.2.3 通知管理
设定各类通知信息的开关
#### 2.2.4 SSH公钥
项目为public公开状态下可以通过http方式进行连接，在private和internal模式下需要使用ssh方式，支持添加ssh公钥来连接gitlab

## 三、功能点优先级与估时
### 项目CRUD
|功能点|M|S|C|W|约束|估时|
|---|---|---|---|---|---|---|
|新建项目|Y| | | | |1.5|
|删除项目|Y| | | | |1|
|查询项目列表|Y| | | | |1|
|搜索项目|Y| | | | |1|
|查看项目基本信息|Y| | | | |0.5|

### 文件
|功能点|M|S|C|W|约束|估时|
|---|---|---|---|---|---|---|
|查看文件|Y| | | | |1|
|编辑文件|Y| | | | |0.5|
|搜索文件|Y| | | | |0.5|
|添加文件| |Y| | | |0.5|
|删除文件| |Y| | | |0.5|

### 提交
|功能点|M|S|C|W|约束|估时|
|---|---|---|---|---|---|---|
|查询提交列表|Y| | | | |1|
|查看提交内容|Y| | | | |1|
|搜索提交|Y|| | | |0.5|
|提交时间线图表|Y| | | | |2|

### tag
|功能点|M|S|C|W|约束|估时|
|---|---|---|---|---|---|---|
|添加tag|Y| | | | |0.5|
|查询tag列表|Y| | | | |0.5|
|搜索tag|Y| | | | |0.5|

### 分支
|功能点|M|S|C|W|约束|估时|
|---|---|---|---|---|---|---|
|查询分支列表|Y| | | | |1|
|搜索分支|Y| | | | |0.5|
|分支比较|Y| | | | |2|

### 统计
|功能点|M|S|C|W|约束|估时|
|---|---|---|---|---|---|---|
|提交统计| |Y| | | |1|
|语言统计| | |Y| | |2|

### 合并请求
|功能点|M|S|C|W|约束|估时|
|---|---|---|---|---|---|---|
|新建请求|Y| | | | |1|
|冲突解决|Y| | | | |2|
|请求关闭|Y| | | | |0.5|
|查询请求列表|Y| | | | |0.5|

### issues
|功能点|M|S|C|W|约束|估时|
|---|---|---|---|---|---|---|
|创建issue| |Y| | | |0.5|
|分配issue给成员| | |Y| | |0.5|
|绑定标签| | |Y| | |0.5|
|绑定里程碑| | |Y| | |0.5|
|关闭issue| |Y| | | |0.5|

### wiki
|功能点|M|S|C|W|约束|估时|
|---|---|---|---|---|---|---|
|添加页面| | |Y| | |0.5|
|删除页面| | |Y| | |0.5|
|编辑页面| | |Y| | |0.5|
|查找页面| | |Y| | |0.5|

### 项目设置
|功能点|M|S|C|W|约束|估时|
|---|---|---|---|---|---|---|
|项目基本设置|Y| | | | |1|
|webhook|Y| | | | |2|
|邀请成员和小组|Y| | | | |1|
|分支保护|Y| | | | |1.5|
|标签保护|Y| | | | |1|

### 组管理
|功能点|M|S|C|W|约束|估时|
|---|---|---|---|---|---|---|
|新建组|Y| | | | |0.5|
|删除组|Y| | | | |0.5|
|查找组|Y| | | | |0.5|
|添加组成员|Y| | | | |0.5|
|设置成员角色与权限|Y| | | | |0.5|
|查看组详情|Y| | | | |0.5|
|从小组新建项目|Y| | | | |0.5|

### 个人设置
|功能点|M|S|C|W|约束|估时|
|---|---|---|---|---|---|---|
|编辑个人基本信息|Y| | | | |0.5|
|上传头像| |Y| | | |0.5|
|邮箱管理|Y| | | | |0.5|
|通知管理|Y| | | | |1|
|添加ssh公钥|Y| | | | |1.5|









