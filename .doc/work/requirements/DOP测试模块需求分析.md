## DOP测试模块需求分析



### 一，概述



测试是保证项目质量的必要手段，对于代码量巨大的项目其重要性不言而喻。Devops强调自动化，所以DOP的测试目标是尽可能做到自动化，文档化。



### 二，Devops测试管理功能点



#### 2.1 静态代码分析

在本次构建的代码被编译部署之前，能够对已有的代码利用代码分析工具进行编译前检查(PMD(阿里巴巴开发规约), FindBugs, CheckStyle)，并且将检查结果友好地展示出来(邮件或者可视化页面)。

- 对于严重的代码缺陷，流水线会终止运行，强制必须修改代码进行修改之后才能重新执行流水线。

- 不是很严重的代码问题，只会产生警告，并不影响流水线的执行。

#### 2.2 测试标准化

测试标准化是独立在流水线之外的比较重要的一个部分，测试标准化的意思即提供统一的测试平台，提供测试用例书写，测试用例分组，测试用例执行，回归测试，性能测试，测试报告生成等一系列的测试功能。

- 测试用例书写

  - 手工测试用例： 需要手工执行的测试用例，包括用例的前置条件，后置条件，执行过程，预计结果，实际结果   

  - http接口测试用例：服务器自动执行的http接口测试用例，自动进行测试返回值正确性校验，需要支持参数传递，请求相关信息填写，请求结果比较，当前请求结果数据作为后续请求参数(因为不同的请求之间可能存在数据依赖)

  - 为了方便书写http接口测试用例，可以支持导入swagger接口数据，自动生成请求url，以及展示需要填写的参数，降低测试用例书写成本。

- 测试用例持久化

  - 所有的测试用例都持久化保存，方便管理以及复用

- 测试用例分组执行

  - 分组的测试用例能够一键执行，生成测试报表

- 性能测试

  - 以组为单位，选择某组测试用例，提供线程数目，线程启动时长，执行次数，以及调度器相关信息，即可进行压测。最终结果以报表形式进行可视化的展示。



#### 2.3 测试用例管理



测试用例管理的功能点需要细分一下：

1.  迭代管理，所有的用例都以迭代为单位进行管理。

2. 测试用例导入导出，方便用户进行测试用例的迁移

3. 用例的一些基本属性：

   ![5c6d547094f19](https://i.loli.net/2019/02/20/5c6d547094f19.png)

    4. 支持根据属性进行用例的搜索，筛选



#### 2.4 测试用例自动执行



支持设置在流水线的某个节点，自动执行某组或者某个迭代的所有测试用例，并且将测试结果以邮件形式通知相关git仓库的所有管理员。



触发执行用例的条件可以在创建项目的时候配置：**部署** 完成之后自动执行 **xxx** 项目的 **xxx** 组测试用例。



### 三，功能点分析

| 用户故事                      | 功能点                    | M   | S   | C   | W   | 约束        | 估时/人日 |
|:-------------------------:|:----------------------:|:---:|:---:|:---:|:---:|:---------:|:-----:|
| 作为用户，我希望能够在代码部署前发现代码存在的问题 | 获取代码的相关检查结果            | Y   |     |     |     |           | 2     |
|                           | 修改存在问题的代码之后再重新开始流水线    | Y   |     |     |     |           | 1.5   |
|                           | 不管报错直接继续执行流水线          | Y   |     |     |     |           | 1.5   |
| 作为用户，我希望能管理测试用例           | 增加测试用例(手工用例和接口用例)      | Y   |     |     |     | 用户管理、权限管理 | 0.5   |
|                           | 修改测试用例                 | Y   |     |     |     |           | 0.5   |
|                           | 删除测试用例                 | Y   |     |     |     |           | 0.5   |
|                           | 按不同属性查询测试用例            | Y   |     |     |     |           | 0.5   |
|                           | (分组)执行测试用例             | Y   |     |     |     |           | 2     |
|                           | 关联用例与需求                |     |     |     | Y   | 需要项目管理配合  | 0.5   |
|                           | 导入导出测试用例               |     |     | Y   |     |           | 1     |
|                           | swagger导入所有项目的接口       |     | Y   |     |     |           | 1     |
|                           | 获取测试用例执行时间，执行次数，查看执行历史 |     | Y   |     |     |           | 2     |
|                           | 编写接口测试用例支持使用全局变量和局部变量  | Y   |     |     |     |           | 1     |
| 作为用户，我希望能查看所有的测试结果        | 测试结果报表展示或者通知           | Y   |     |     |     |           | 2     |
|                           | 测试结果导出                 |     |     | Y   |     |           | 1     |
| 作为用户，我希望能够进行服务器性能测试       | 编辑压测配置                 | Y   |     |     |     |           | 4     |
|                           | 查看压测结果                 | Y   |     |     |     |           | 1     |
| 作为用户，我希望测试用例能够自动执行        | 配置测试用例触发条件             | Y   |     |     |     |           | 1     |
|                           | 测试结果通知                 | Y   |     |     |     |           | 1     |


